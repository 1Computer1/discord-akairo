<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>utils/ClientUtil.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Category.html">Category</a></li><li><a href="ClientUtil.html">ClientUtil</a></li><li><a href="Command.html">Command</a></li><li><a href="CommandHandler.html">CommandHandler</a></li><li><a href="DatabaseHandler.html">DatabaseHandler</a></li><li><a href="Framework.html">Framework</a></li><li><a href="Inhibitor.html">Inhibitor</a></li><li><a href="InhibitorHandler.html">InhibitorHandler</a></li><li><a href="Listener.html">Listener</a></li><li><a href="ListenerHandler.html">ListenerHandler</a></li><li><a href="SQLiteHandler.html">SQLiteHandler</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">utils/ClientUtil.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const PERMISSIONS = {
    CREATE_INSTANT_INVITE: 1 &lt;&lt; 0,
    KICK_MEMBERS: 1 &lt;&lt; 1,
    BAN_MEMBERS: 1 &lt;&lt; 2,
    ADMINISTRATOR: 1 &lt;&lt; 3,
    MANAGE_CHANNELS: 1 &lt;&lt; 4,
    MANAGE_GUILD: 1 &lt;&lt; 5,
    ADD_REACTIONS: 1 &lt;&lt; 6,

    READ_MESSAGES: 1 &lt;&lt; 10,
    SEND_MESSAGES: 1 &lt;&lt; 11,
    SEND_TTS_MESSAGES: 1 &lt;&lt; 12,
    MANAGE_MESSAGES: 1 &lt;&lt; 13,
    EMBED_LINKS: 1 &lt;&lt; 14,
    ATTACH_FILES: 1 &lt;&lt; 15,
    READ_MESSAGE_HISTORY: 1 &lt;&lt; 16,
    MENTION_EVERYONE: 1 &lt;&lt; 17,
    EXTERNAL_EMOJIS: 1 &lt;&lt; 18,

    CONNECT: 1 &lt;&lt; 20,
    SPEAK: 1 &lt;&lt; 21,
    MUTE_MEMBERS: 1 &lt;&lt; 22,
    DEAFEN_MEMBERS: 1 &lt;&lt; 23,
    MOVE_MEMBERS: 1 &lt;&lt; 24,
    USE_VAD: 1 &lt;&lt; 25,

    CHANGE_NICKNAME: 1 &lt;&lt; 26,
    MANAGE_NICKNAMES: 1 &lt;&lt; 27,
    MANAGE_ROLES_OR_PERMISSIONS: 1 &lt;&lt; 28,
    MANAGE_WEBHOOKS: 1 &lt;&lt; 29,
    MANAGE_EMOJIS: 1 &lt;&lt; 30,
};

class ClientUtil {
    /**
     * Client utilities to help with common tasks. Accessible in client.util.
     * @param {Client} client - The Discord.js client.
     */
    constructor(client){
        /** 
         * The Discord.js client. 
         * @readonly
         * @type {Client}
         */
        this.client = client;
    }

    /**
     * Resolves a User from a string, such as an ID, a username, etc.
     * @param {string} text - Text to resolve.
     * @param {boolean} [caseSensitive=false] - Makes finding by name case sensitive.
     * @param {boolean} [wholeWord=false] - Makes finding by name match full word only.
     * @returns {User}
     */
    resolveUser(text, caseSensitive = false, wholeWord = false){
        let users = this.client.users;

        let reg = /&lt;@!?(\d+)>/;
        if (reg.test(text)){
            let id = text.match(reg)[1];
            return users.get(id);
        }

        let check = u => {
            let username = caseSensitive ? u.username : u.username.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return username === t || username === t.split('#')[0] &amp;&amp; u.discriminator === t.split('#')[1];
        };

        let checkInc = u => {
            let username = caseSensitive ? u.username : u.username.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return username.includes(t) || username.includes(t.split('#')[0]) &amp;&amp; u.discriminator.includes(t.split('#')[1]);
        };

        return users.get(text) || users.find(check) || !wholeWord ? users.find(checkInc) : null;
    }

    /**
     * Resolves a GuildMember from a string, such as an ID, a nickname, a username, etc.
     * @param {string} text - Text to resolve.
     * @param {Guild} [guild] - Guild to find member in. If not specified, will resolve a User instead.
     * @param {boolean} [caseSensitive=false] - Makes finding by name case sensitive.
     * @param {boolean} [wholeWord=false] - Makes finding by name match full word only.
     * @returns {GuildMember|User}
     */
    resolveMember(text, guild, caseSensitive = false, wholeWord = false){
        if (!guild) return this.resolveUser(text);

        let members = guild.members;

        let reg = /&lt;@!?(\d+)>/;
        if (reg.test(text)){
            let id = text.match(reg)[1];
            return members.get(id);
        }

        let check = m => {
            let username = caseSensitive ? m.user.username : m.user.username.toLowerCase();
            let displayName = caseSensitive ? m.displayName : m.displayName.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return displayName === t || username === t || username === t.split('#')[0] &amp;&amp; m.user.discriminator === t.split('#')[1];
        };

        let checkInc = m => {
            let username = caseSensitive ? m.user.username : m.user.username.toLowerCase();
            let displayName = caseSensitive ? m.displayName : m.displayName.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return displayName.includes(t) || username.includes(t) || username.includes(t.split('#')[0]) &amp;&amp; m.user.discriminator.includes(t.split('#')[1]);
        };

        return members.get(text) || members.find(check) || !wholeWord ? members.find(checkInc) : null;
    }

    /**
     * Resolves a GuildChannel from a string, such as an ID, a name, etc.
     * @param {string} text - Text to resolve.
     * @param {Guild} guild - Guild to find channel in.
     * @param {boolean} [caseSensitive=false] - Makes finding by name case sensitive.
     * @param {boolean} [wholeWord=false] - Makes finding by name match full word only.
     * @returns {GuildChannel}
     */
    resolveChannel(text, guild, caseSensitive = false, wholeWord = false){
        if (!guild) throw new Error('Guild must be specified.');

        let channels = guild.channels;

        let reg = /&lt;#(\d+)>/;
        if (reg.test(text)){
            let id = text.match(reg)[1];
            return channels.get(id);
        }

        let check = c => {
            let name = caseSensitive ? c.name : c.name.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return name === t || name === t.replace(/^#/, '');
        };

        let checkInc = c => {
            let name = caseSensitive ? c.name : c.name.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return name.includes(t) || name.includes(t.replace(/^#/, ''));
        };

        return channels.get(text) || channels.find(check) || !wholeWord ? channels.find(checkInc) : null;
    }

    /**
     * Resolves a Role from a string, such as an ID, a name, etc.
     * @param {string} text - Text to resolve.
     * @param {Guild} guild - Guild to find channel in.
     * @param {boolean} [caseSensitive=false] - Makes finding by name case sensitive.
     * @param {boolean} [wholeWord=false] - Makes finding by name match full word only.
     * @returns {Role}
     */
    resolveRole(text, guild, caseSensitive = false, wholeWord = false){
        if (!guild) throw new Error('Guild must be specified.');

        let roles = guild.roles;

        let reg = /&lt;@&amp;(\d+)>/;
        if (reg.test(text)){
            let id = text.match(reg)[1];
            return roles.get(id);
        }

        let check = r => {
            let name = caseSensitive ? r.name : r.name.toLowerCase();
            let t = caseSensitive ? t : text.toLowerCase();

            return name === t || name === t.replace(/^@/, '');
        };

        let checkInc = r => {
            let name = caseSensitive ? r.name : r.name.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return name.includes(t) || name.includes(t.replace(/^@/, ''));
        };

        return roles.get(text) || roles.find(check) || !wholeWord ? roles.find(checkInc) : null;
    }

    /**
     * Resolves an Emoji from a string, such as a name or a mention.
     * @param {string} text - Text to resolve.
     * @param {Guild} guild - Guild to find emoji in.
     * @param {boolean} [caseSensitive=false] - Makes finding by name case sensitive.
     * @param {boolean} [wholeWord=false] - Makes finding by name match full word only.
     * @returns {Emoji}
     */
    resolveEmoji(text, guild, caseSensitive = false, wholeWord = false){
        if (!guild) throw new Error('Guild must be specified.');

        let emojis = guild.emojis;

        let reg = /&lt;:[a-zA-Z0-9_]+:(\d+)>/;
        if (reg.test(text)){
            let id = text.match(reg)[1];
            return emojis.get(id);
        }

        let check = e => {
            let name = caseSensitive ? e.name : e.name.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return name === t || name === t.replace(/:/g, '');
        };

        let checkInc = e => {
            let name = caseSensitive ? e.name : e.name.toLowerCase();
            let t = caseSensitive ? text : text.toLowerCase();

            return name.includes(t) || name.includes(t.replace(/:/g, ''));
        };

        return emojis.get(text) || emojis.find(check) || !wholeWord ? emojis.find(checkInc) : null;
    }

    /**
     * Resolves a Guild from a string, such as an ID, or name.
     * @param {string} text - Text to resolve.
     * @param {boolean} [caseSensitive=false] - Makes finding by name case sensitive.
     * @param {boolean} [wholeWord=false] - Makes finding by name match full word only.
     * @returns {Guild}
     */
    resolveGuild(text, caseSensitive = false, wholeWord = false){
        let guilds = this.client.guilds;

        let check = g => {
            let name = caseSensitive ? g.name : g.name.toLowerCase();
            let t = caseSensitive ? t : text.toLowerCase();

            return name === t;
        };

        let checkInc = g => {
            let name = caseSensitive ? g.name : g.name.toLowerCase();
            let t = caseSensitive ? t : text.toLowerCase();

            return name.includes(t);
        };

        return guilds.get(text) || guilds.find(check) || !wholeWord ? guilds.find(checkInc) : null;
    }

    /**
     * Gets the display color in decimal of the member.
     * @param {GuildMember} member - The member to find color of.
     * @returns {number}
     */
    displayColor(member){
        let roles = member.roles.filter(r => r.color !== 0);
        if (roles.size === 0) return 0;

        let highest = Math.max(...roles.map(r => r.position));
        return roles.find(r => r.position === highest).color;
    }

    /**
     * Creates an invite link for the client.
     * @param {(number|PermissionResolvable[])} [permissions=0] - Permissions number or array of PermissionResolvables.
     * @return {Promise.&lt;string>}
     */
    createInvite(permissions = 0){
        return new Promise((resolve, reject) => {
            let perms = typeof permissions === 'number' ? permissions : this.client.resolver.resolvePermissions(permissions);

            this.client.fetchApplication().then(app => {
                let invite = `https://discordapp.com/oauth2/authorize?permissions=${perms}&amp;scope=bot&amp;client_id=${app.id}`;
                resolve(invite);
            }).catch(reject);
        });
    }

    /**
     * Resolves a permission number and returns an array of permission names.
     * @param {number} number - The permissions number.
     * @returns {string[]}
     */
    resolvePermissionNumber(number){
        let resolved = [];

        Object.keys(PERMISSIONS).forEach(key => {
            if (number &amp; PERMISSIONS[key]) resolved.push(key);
        });

        return resolved;
    }
}

module.exports = ClientUtil;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
